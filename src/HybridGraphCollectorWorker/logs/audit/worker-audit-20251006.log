[2025-10-06 06:57:24.974 -04:00] Starting Concurrent Hybrid Graph Collector Worker
[2025-10-06 06:57:26.418 -04:00] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "type" = 'table' AND "rootpage" IS NOT NULL;
[2025-10-06 06:57:26.542 -04:00] AUDIT: ConcurrentWorkerServiceStarted | Custodian: null | CorrelationId: 3a9161b3 | Data: {"Action":"ConcurrentWorkerServiceStarted","Custodian":null,"Data":{"Version":"2.0.0","Environment":"Development","ConcurrentEnabled":true},"Instance":"DONNELLD-BOOK-3-47788","Timestamp":"2025-10-06T10:57:26.4549674Z","CorrelationId":"3a9161b3"}
[2025-10-06 06:57:26.544 -04:00] Concurrent Hybrid Graph Collector Worker started successfully
[2025-10-06 06:57:26.725 -04:00] AutoRouter configured with thresholds: 10.0 GB, 50,000 items
[2025-10-06 06:57:26.743 -04:00] Graph Data Connect Service Bus connection not configured - running in stub mode
[2025-10-06 06:57:26.765 -04:00] Hybrid Graph Collector Worker started at: "2025-10-06T06:57:26.7651308-04:00" | CorrelationId: d8b3b678
[2025-10-06 06:57:26.777 -04:00] AUDIT: WorkerServiceExecutionStarted | Custodian: null | CorrelationId: d8b3b678 | Data: {"Action":"WorkerServiceExecutionStarted","Custodian":null,"Data":{"StartTime":"2025-10-06T06:57:26.7703595-04:00"},"Instance":"DONNELLD-BOOK-3-47788","Timestamp":"2025-10-06T10:57:26.770478Z","CorrelationId":"d8b3b678"}
[2025-10-06 06:57:26.797 -04:00] Processing sample collection job for custodian: test.user@development.com | CorrelationId: c0571cb4
[2025-10-06 06:57:26.815 -04:00] JobStarted | {"EventType":"JobStarted","CustodianEmail":"test.user@development.com","JobType":"Email","StartDate":"2025-09-06T10:57:26.8012147Z","EndDate":"2025-10-06T10:57:26.8012756Z","Keywords":["contract","agreement"],"IncludeAttachments":true,"OutputPath":"./output","Timestamp":"2025-10-06T10:57:26.8023878Z","CorrelationId":"c0571cb4"}
[2025-10-06 06:57:26.818 -04:00] AUDIT: JobStarted | Custodian: null | CorrelationId: c0571cb4 | Data: {"Action":"JobStarted","Custodian":null,"Data":{"EventType":"JobStarted","CustodianEmail":"test.user@development.com","JobType":"Email","StartDate":"2025-09-06T10:57:26.8012147Z","EndDate":"2025-10-06T10:57:26.8012756Z","Keywords":["contract","agreement"],"IncludeAttachments":true,"OutputPath":"./output","Timestamp":"2025-10-06T10:57:26.8023878Z","CorrelationId":"c0571cb4"},"Instance":"DONNELLD-BOOK-3-47788","Timestamp":"2025-10-06T10:57:26.8182054Z","CorrelationId":"c0571cb4"}
[2025-10-06 06:57:26.825 -04:00] Determining optimal route for custodian: test.user@development.com | CorrelationId: 13ec70e4
[2025-10-06 06:57:26.832 -04:00] AUDIT: AutoRouterDecisionStarted | Custodian: test.user@development.com | CorrelationId: 13ec70e4 | Data: {"Action":"AutoRouterDecisionStarted","Custodian":"test.user@development.com","Data":{"CustodianEmail":"test.user@development.com","JobType":"Email","DateRange":{"StartDate":"2025-09-06T10:57:26.8012147Z","EndDate":"2025-10-06T10:57:26.8012756Z"}},"Instance":"DONNELLD-BOOK-3-47788","Timestamp":"2025-10-06T10:57:26.8283473Z","CorrelationId":"13ec70e4"}
[2025-10-06 06:57:26.842 -04:00] GDC Fetch Worker started. Input kind: nas
[2025-10-06 06:57:26.845 -04:00] Application started. Press Ctrl+C to shut down.
[2025-10-06 06:57:26.846 -04:00] Hosting environment: Development
[2025-10-06 06:57:26.849 -04:00] Content root path: C:\Users\dnnll\source\repos\_VisualStudio_Code\M365Test\src\HybridGraphCollectorWorker
[2025-10-06 06:57:26.866 -04:00] Collection estimates - Size: 5368709120 bytes (5120.00 MB), Items: 10000 | CorrelationId: 13ec70e4
[2025-10-06 06:57:26.876 -04:00] Route decision: Graph Data Connect selected - current quota already exceeded | CorrelationId: 13ec70e4
[2025-10-06 06:57:26.877 -04:00] Route decision completed: "GraphDataConnect" (Confidence: 95.0 %) | CorrelationId: 13ec70e4
[2025-10-06 06:57:26.890 -04:00] AUDIT: AutoRouterDecisionCompleted | Custodian: test.user@development.com | CorrelationId: 13ec70e4 | Data: {"Action":"AutoRouterDecisionCompleted","Custodian":"test.user@development.com","Data":{"RecommendedRoute":"GraphDataConnect","Reason":"Current quota usage exceeds Graph API thresholds","ConfidenceScore":0.95,"EstimatedSize":5368709120,"EstimatedItems":10000,"QuotaUsage":{"UsedBytes":53687091200,"UsedItems":250000}},"Instance":"DONNELLD-BOOK-3-47788","Timestamp":"2025-10-06T10:57:26.8820267Z","CorrelationId":"13ec70e4"}
[2025-10-06 06:57:26.895 -04:00] PERFORMANCE: AutoRouter.DetermineOptimalRoute | Duration: 71ms | Items: 0 | Size: 0 bytes | CorrelationId: 13ec70e4 | Throughput: 0.00 items/sec, 0.00 MB/sec
[2025-10-06 06:57:26.903 -04:00] [Job 0] [AutoRouter] Route decision: GraphDataConnect Reason: Current quota usage exceeds Graph API thresholds. Confidence: 95.0%
[2025-10-06 06:57:26.910 -04:00] AutoRoutedToGDC | {"EventType":"AutoRoutedToGDC","CustodianEmail":"test.user@development.com","JobType":"Email","RecommendedRoute":"GraphDataConnect","Reason":"Current quota usage exceeds Graph API thresholds","ConfidenceScore":0.95,"EstimatedDataSizeBytes":5368709120,"EstimatedItemCount":10000,"Timestamp":"2025-10-06T10:57:26.9069121Z","CorrelationId":"c0571cb4"}
[2025-10-06 06:57:26.912 -04:00] AUDIT: AutoRoutedToGDC | Custodian: null | CorrelationId: c0571cb4 | Data: {"Action":"AutoRoutedToGDC","Custodian":null,"Data":{"EventType":"AutoRoutedToGDC","CustodianEmail":"test.user@development.com","JobType":"Email","RecommendedRoute":"GraphDataConnect","Reason":"Current quota usage exceeds Graph API thresholds","ConfidenceScore":0.95,"EstimatedDataSizeBytes":5368709120,"EstimatedItemCount":10000,"Timestamp":"2025-10-06T10:57:26.9069121Z","CorrelationId":"c0571cb4"},"Instance":"DONNELLD-BOOK-3-47788","Timestamp":"2025-10-06T10:57:26.912618Z","CorrelationId":"c0571cb4"}
[2025-10-06 06:57:26.918 -04:00] Graph Data Connect collection requested for job type: "Email"
[2025-10-06 06:57:26.922 -04:00] Triggering Graph Data Connect collection for custodian: test.user@development.com | CorrelationId: 78819818
[2025-10-06 06:57:26.927 -04:00] AUDIT: GdcCollectionTriggered | Custodian: test.user@development.com | CorrelationId: 78819818 | Data: {"Action":"GdcCollectionTriggered","Custodian":"test.user@development.com","Data":{"CustodianEmail":"test.user@development.com","JobType":"Email","DateRange":{"StartDate":"2025-09-06T10:57:26.8012147Z","EndDate":"2025-10-06T10:57:26.8012756Z"},"TriggerType":"AzureDataFactory"},"Instance":"DONNELLD-BOOK-3-47788","Timestamp":"2025-10-06T10:57:26.9256535Z","CorrelationId":"78819818"}
[2025-10-06 06:57:26.972 -04:00] GDC Stub Mode - Would send trigger message to ADF:
{
  "pipelineRunId": "a5ddf44f245c4ca4b248ec1a332be4b6",
  "collectionRequest": {
    "custodianEmail": "test.user@development.com",
    "jobType": 1,
    "startDate": "2025-09-06T10:57:26.8012147Z",
    "endDate": "2025-10-06T10:57:26.8012756Z",
    "keywords": [
      "contract",
      "agreement"
    ],
    "includeAttachments": true,
    "outputPath": "./output"
  },
  "triggeredAt": "2025-10-06T10:57:26.9316556Z",
  "correlationId": "78819818",
  "priority": 2,
  "estimatedDuration": "01:00:00",
  "retryPolicy": {
    "maxRetries": 3,
    "retryDelayMinutes": 15,
    "exponentialBackoff": true,
    "retryableErrors": [
      "ThrottlingError",
      "TemporaryServiceUnavailable",
      "InternalServerError"
    ]
  },
  "configuration": {
    "outputFormat": "Parquet",
    "compressionType": "Snappy",
    "partitionBy": [
      "custodianEmail",
      "date"
    ],
    "enableDeltaLake": true,
    "dataRetentionDays": 2555,
    "enableEncryption": true,
    "notificationEndpoints": []
  }
}
[2025-10-06 06:57:28.118 -04:00] AUDIT: GdcCollectionTriggered | Custodian: test.user@development.com | CorrelationId: 78819818 | Data: {"Action":"GdcCollectionTriggered","Custodian":"test.user@development.com","Data":{"PipelineRunId":"a5ddf44f245c4ca4b248ec1a332be4b6","TriggerMessage":{"pipelineRunId":"a5ddf44f245c4ca4b248ec1a332be4b6","collectionRequest":{"CustodianEmail":"test.user@development.com","JobType":1,"StartDate":"2025-09-06T10:57:26.8012147Z","EndDate":"2025-10-06T10:57:26.8012756Z","Keywords":["contract","agreement"],"IncludeAttachments":true,"OutputPath":"./output"},"triggeredAt":"2025-10-06T10:57:26.9316556Z","correlationId":"78819818","priority":2,"estimatedDuration":"01:00:00","retryPolicy":{"maxRetries":3,"retryDelayMinutes":15,"exponentialBackoff":true,"retryableErrors":["ThrottlingError","TemporaryServiceUnavailable","InternalServerError"]},"configuration":{"outputFormat":"Parquet","compressionType":"Snappy","partitionBy":["custodianEmail","date"],"enableDeltaLake":true,"dataRetentionDays":2555,"enableEncryption":true,"notificationEndpoints":[]}},"ServiceBusEnabled":false},"Instance":"DONNELLD-BOOK-3-47788","Timestamp":"2025-10-06T10:57:28.1069644Z","CorrelationId":"78819818"}
[2025-10-06 06:57:28.122 -04:00] Graph Data Connect collection triggered successfully for custodian: test.user@development.com | PipelineRunId: a5ddf44f245c4ca4b248ec1a332be4b6
[2025-10-06 06:57:28.125 -04:00] Collection completed successfully. Items: 0, Size: 0 bytes | CorrelationId: c0571cb4
[2025-10-06 06:57:28.130 -04:00] JobCompleted | {"EventType":"JobCompleted","CustodianEmail":"test.user@development.com","JobType":"Email","IsSuccessful":true,"ItemCount":0,"SizeBytes":0,"DurationMs":1303,"ErrorMessage":null,"StartTime":null,"EndTime":null,"Timestamp":"2025-10-06T10:57:28.1290988Z","CorrelationId":"c0571cb4"}
[2025-10-06 06:57:28.132 -04:00] AUDIT: JobCompleted | Custodian: null | CorrelationId: c0571cb4 | Data: {"Action":"JobCompleted","Custodian":null,"Data":{"EventType":"JobCompleted","CustodianEmail":"test.user@development.com","JobType":"Email","IsSuccessful":true,"ItemCount":0,"SizeBytes":0,"DurationMs":1303,"ErrorMessage":null,"StartTime":null,"EndTime":null,"Timestamp":"2025-10-06T10:57:28.1290988Z","CorrelationId":"c0571cb4"},"Instance":"DONNELLD-BOOK-3-47788","Timestamp":"2025-10-06T10:57:28.1328276Z","CorrelationId":"c0571cb4"}
[2025-10-06 06:57:28.591 -04:00] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "d"."Id", "d"."BaselineCompletedAt", "d"."CollectionJobId", "d"."CreatedDate", "d"."CustodianEmail", "d"."DeltaQueryCount", "d"."DeltaToken", "d"."DeltaType", "d"."ErrorMessage", "d"."IsActive", "d"."LastDeltaItemCount", "d"."LastDeltaSizeBytes", "d"."LastDeltaTime", "d"."Metadata", "d"."ScopeId", "d"."UpdatedDate"
FROM "DeltaCursors" AS "d"
WHERE "d"."IsActive"
ORDER BY "d"."LastDeltaTime"
[2025-10-06 06:57:28.624 -04:00] PERFORMANCE: Worker.ProcessDeltaQueries | Duration: 487ms | Items: 0 | Size: 0 bytes | CorrelationId: b5fa335c | Throughput: 0.00 items/sec, 0.00 MB/sec
[2025-10-06 06:57:28.629 -04:00] PERFORMANCE: Worker.ProcessPendingJobs | Duration: 1846ms | Items: 0 | Size: 0 bytes | CorrelationId: 82217e94 | Throughput: 0.00 items/sec, 0.00 MB/sec
[2025-10-06 06:57:43.714 -04:00] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "d"."Id", "d"."BaselineCompletedAt", "d"."CollectionJobId", "d"."CreatedDate", "d"."CustodianEmail", "d"."DeltaQueryCount", "d"."DeltaToken", "d"."DeltaType", "d"."ErrorMessage", "d"."IsActive", "d"."LastDeltaItemCount", "d"."LastDeltaSizeBytes", "d"."LastDeltaTime", "d"."Metadata", "d"."ScopeId", "d"."UpdatedDate"
FROM "DeltaCursors" AS "d"
WHERE "d"."IsActive"
ORDER BY "d"."LastDeltaTime"
[2025-10-06 06:57:43.726 -04:00] PERFORMANCE: Worker.ProcessDeltaQueries | Duration: 82ms | Items: 0 | Size: 0 bytes | CorrelationId: 43e16231 | Throughput: 0.00 items/sec, 0.00 MB/sec
[2025-10-06 06:57:43.728 -04:00] PERFORMANCE: Worker.ProcessPendingJobs | Duration: 89ms | Items: 0 | Size: 0 bytes | CorrelationId: 0beb4ab4 | Throughput: 0.00 items/sec, 0.00 MB/sec
[2025-10-06 06:57:58.754 -04:00] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "d"."Id", "d"."BaselineCompletedAt", "d"."CollectionJobId", "d"."CreatedDate", "d"."CustodianEmail", "d"."DeltaQueryCount", "d"."DeltaToken", "d"."DeltaType", "d"."ErrorMessage", "d"."IsActive", "d"."LastDeltaItemCount", "d"."LastDeltaSizeBytes", "d"."LastDeltaTime", "d"."Metadata", "d"."ScopeId", "d"."UpdatedDate"
FROM "DeltaCursors" AS "d"
WHERE "d"."IsActive"
ORDER BY "d"."LastDeltaTime"
[2025-10-06 06:57:58.762 -04:00] PERFORMANCE: Worker.ProcessDeltaQueries | Duration: 21ms | Items: 0 | Size: 0 bytes | CorrelationId: b0195958 | Throughput: 0.00 items/sec, 0.00 MB/sec
[2025-10-06 06:57:58.764 -04:00] PERFORMANCE: Worker.ProcessPendingJobs | Duration: 29ms | Items: 0 | Size: 0 bytes | CorrelationId: 89b5bf76 | Throughput: 0.00 items/sec, 0.00 MB/sec
[2025-10-06 06:58:13.795 -04:00] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "d"."Id", "d"."BaselineCompletedAt", "d"."CollectionJobId", "d"."CreatedDate", "d"."CustodianEmail", "d"."DeltaQueryCount", "d"."DeltaToken", "d"."DeltaType", "d"."ErrorMessage", "d"."IsActive", "d"."LastDeltaItemCount", "d"."LastDeltaSizeBytes", "d"."LastDeltaTime", "d"."Metadata", "d"."ScopeId", "d"."UpdatedDate"
FROM "DeltaCursors" AS "d"
WHERE "d"."IsActive"
ORDER BY "d"."LastDeltaTime"
[2025-10-06 06:58:13.812 -04:00] PERFORMANCE: Worker.ProcessDeltaQueries | Duration: 32ms | Items: 0 | Size: 0 bytes | CorrelationId: 9bd1846b | Throughput: 0.00 items/sec, 0.00 MB/sec
[2025-10-06 06:58:13.814 -04:00] PERFORMANCE: Worker.ProcessPendingJobs | Duration: 39ms | Items: 0 | Size: 0 bytes | CorrelationId: d491bdff | Throughput: 0.00 items/sec, 0.00 MB/sec
[2025-10-06 06:58:28.842 -04:00] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "d"."Id", "d"."BaselineCompletedAt", "d"."CollectionJobId", "d"."CreatedDate", "d"."CustodianEmail", "d"."DeltaQueryCount", "d"."DeltaToken", "d"."DeltaType", "d"."ErrorMessage", "d"."IsActive", "d"."LastDeltaItemCount", "d"."LastDeltaSizeBytes", "d"."LastDeltaTime", "d"."Metadata", "d"."ScopeId", "d"."UpdatedDate"
FROM "DeltaCursors" AS "d"
WHERE "d"."IsActive"
ORDER BY "d"."LastDeltaTime"
[2025-10-06 06:58:28.853 -04:00] PERFORMANCE: Worker.ProcessDeltaQueries | Duration: 22ms | Items: 0 | Size: 0 bytes | CorrelationId: f364ba55 | Throughput: 0.00 items/sec, 0.00 MB/sec
[2025-10-06 06:58:28.855 -04:00] PERFORMANCE: Worker.ProcessPendingJobs | Duration: 28ms | Items: 0 | Size: 0 bytes | CorrelationId: d64893a9 | Throughput: 0.00 items/sec, 0.00 MB/sec
[2025-10-06 06:58:37.125 -04:00] Application is shutting down...
[2025-10-06 06:58:37.130 -04:00] GDC Fetch Worker is stopping due to cancellation
